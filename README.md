# Signal Processing for Medical Devices
BMEN6000E - Fall 2025
Columbia University


## Lab 1 - Temperature monitoring
This lab demonstrates an understanding of the **Wheatstone bridge circuit** by collecting real-time signal processing data using a _physiological (temperature) sensor_. By curve fitting the Steinhart-Hart equation, the measured resistance values are interpolated with known temperatures to calculate the calibration points, or Steinhart-Hart coefficients, in order to compute the temperature readings of the system. By evaluating all, 10-, and 100-time point intervals for the moving average at standard increments of temperature measured from the thermistor, the level of noise in the system can be observed to gauge the variability in hardware tolerances and data processing that ultimately influences the accuracy and precision of the results. 


## Lab 2 - Photoplethysmography (PPG)
This lab demonstrates an understanding of _photoplethysmography (PPG) sensors_ to measure **blood oxygenation, pulse rate (heart rate), and respiratory rate**. The red and infrared lights can be measured to estimate the hemoglobin oxygen saturation of arterial blood, represented as an AC signal that is superimposed on a DC signal. By taking the derivative and thresholding, SPO2 and heart rate can be calculated for event detection. By removing the DC component from the infrared signal and obtaining the inter-beat interval through the lag (shift), the autocorrelation can be calculated. Lastly, the Fourier transform can transform the infrared signal into a frequency domain to detect peaks, resulting in another method of computing heart rate. When comparing the library-computed heart rate, the rapid response, noise, and accuracy of the manually calculated heart rates can be evaluated. 


## Lab 3 - Glucometer
This lab demonstrates an understanding of **food absorption and glucose-insulin dynamics** between normal and diabetic subjects by modelling a system of three nonlinear ordinary differential equations and using a _glucometer_ to measure glucose concentration. By curve fitting glucose concentration and modelling its _closed loop system with a PID (Proportional-Integer-Derivative) controller_, the dynamics model can be simulated to calculate the glucose intake D(t), glucose absorption Q(t), and blood glucose concentration G(t) over time. By modeling various scenarios with bolus (impulse function) or basal rate added to the meal intake, the optimal PID values can be determined empirically to simulate the closed loop feedback control system of the glucose-insulin dynamics.


## Lab 4 - Electrocardiogram (ECG)
The purpose of this experiment is to demonstrate an understanding of **electrocardiogram signal processing** through supervised learning of a _machine learning model (CNN)_ with heart rate readings to diagnose varying conditions. By designing a flowchart, the structure of the algorithm to diagnose such a condition can be determined. In Python, a convolutional neural network can be supplied with labeled ECG data that is split between a training set and testing set to identify and classify features accordingly. Using a confusion matrix and outputting descriptive statistics, the accuracy of the model can be assessed across different combinations of test-train sets, number of CNN filters, number of epochs, and various hyperparameters to evaluate the best performing model with the least amount of time.

## Lab 5 - Design of Experiments
The purpose of this experiment is to apply **design-of-experiments principles to early-stage prototyping** by developing and executing signal-processing-based test plans with a _physiological color sensor_. The AS7341 color sensor is intended to be implemented in a ketone test strip device to automatically and accurately measure ketone levels from a urine sample color strip. The sensor measures the amount of light present within different wavelengths to detect the shade of color on the test strip, which corresponds to a specific level on a ketone concentration chart. By creating a calibration curve and computing the 10-point and 50-point moving averages, the color sensor readings stabilize within 10-20 seconds to precisely distinguish the manufacture-defined ketone levels based on the color of the ketone test strip, achieving the required accuracy sufficient for reliable classification. By computing the derivative of the sensor signal, abrupt changes in the readings can be used to flag faulty measurements due to poor lighting, improper sensor proximity, or noise, ultimately improving the reliability of ketone detection for the screening of diabetic ketoacidosis.